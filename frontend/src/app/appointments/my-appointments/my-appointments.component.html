<app-navbar />
<h2>My Appointments</h2>
@if (loading) {
  <div>Loading appointments...</div>
}
@if (error) {
  <div class="error">{{ error }}</div>
}
@if (!loading && !error && appointments.length === 0) {
  <div>No appointments found for this week.</div>
}
@if (appointments.length > 0) {
  <div *ngFor="let appt of appointments; trackBy: trackById" class="appointment-card">
    <div class="appt-header">
      <strong>{{ appt.patientName }}</strong> | {{ appt.startTime | date:'short' }} | {{ appt.durationMinutes }} min | Status: {{ appt.status }}
      <button type="button" (click)="appt.showHistory = !appt.showHistory">{{ appt.showHistory ? 'Hide' : 'Show' }} Status History</button>
    </div>
    <div *ngIf="appt.showHistory">
      <app-appointment-status-history [appointmentId]="appt.appointmentId"></app-appointment-status-history>
    </div>
  </div>
  <app-provider-calendar [appointments]="appointments" />
}
